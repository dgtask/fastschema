(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[413],{28003:function(e,r,t){Promise.resolve().then(t.bind(t,1990))},1990:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return x}});var n=t(57437),i=t(30248),s=t(27453),o=t(15671),a=t(80244),l=t(21270),c=t(2265),u=t(22782),d=t(47907),f=t(82670),m=t(57654),p=t(53365);let h=i.Ry({token:i.Z_().trim().min(1,{message:"Token is required"}),username:i.Z_().trim().min(1,{message:"Username or email is required"}),email:i.Z_().email({message:"Invalid email address"}),password:i.Z_().trim().min(1,{message:"Password is required"})});function x(){let[e,r]=(0,c.useState)(!1),t=(0,d.useSearchParams)().get("token"),i=(0,d.useRouter)(),x=(0,f.cI)({resolver:(0,l.F)(h),defaultValues:{token:null!=t?t:"",username:"",email:"",password:""}}),v=async e=>{r(!0);try{await (0,p.cY)(e)?(i.push("/login"),s.Vp("Setup successful")):s.vU("Setup failed")}catch(e){}r(!1)};return t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("title",{children:"Setup - Fastschema"}),(0,n.jsx)("div",{className:"flex flex-col items-center justify-center px-6 py-8 mx-auto md:h-screen lg:py-0",children:(0,n.jsx)(a.l0,{...x,children:(0,n.jsx)("form",{onSubmit:x.handleSubmit(v),className:"space-y-8",children:(0,n.jsxs)(o.Zb,{className:"w-full max-w-sm",children:[(0,n.jsxs)(o.Ol,{children:[(0,n.jsx)(o.ll,{className:"text-2xl",children:"Setup - Fastschema"}),(0,n.jsx)(o.SZ,{children:"Please provide the following details to setup your application."})]}),(0,n.jsxs)(o.aY,{className:"grid gap-4",children:[(0,n.jsx)(a.Wi,{control:x.control,name:"username",render:e=>{let{field:r}=e;return(0,n.jsxs)(a.xJ,{children:[(0,n.jsx)(a.lX,{children:"Username"}),(0,n.jsx)(a.NI,{children:(0,n.jsx)(u.I,{placeholder:"Admin username",...r})}),(0,n.jsx)(a.zG,{})]})}}),(0,n.jsx)(a.Wi,{control:x.control,name:"email",render:e=>{let{field:r}=e;return(0,n.jsxs)(a.xJ,{children:[(0,n.jsx)(a.lX,{children:"Email"}),(0,n.jsx)(a.NI,{children:(0,n.jsx)(u.I,{placeholder:"Admin email address",...r})}),(0,n.jsx)(a.zG,{})]})}}),(0,n.jsx)(a.Wi,{control:x.control,name:"password",render:e=>{let{field:r}=e;return(0,n.jsxs)(a.xJ,{children:[(0,n.jsx)(a.lX,{children:"Password"}),(0,n.jsx)(a.NI,{children:(0,n.jsx)(u.I,{placeholder:"••••••••",type:"password",...r})}),(0,n.jsx)(a.zG,{})]})}})]}),(0,n.jsx)(o.eW,{children:(0,n.jsx)(m.z,{type:"submit",className:"w-full",loading:e,children:"Setup"})})]})})})})]}):(0,n.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,n.jsxs)("div",{className:"p-4 space-y-4 text-center",children:[(0,n.jsx)("h1",{className:"text-2xl",children:"Invalid setup token"}),(0,n.jsx)("p",{className:"text-gray-500",children:"The setup token is invalid or has expired."}),(0,n.jsx)(m.z,{onClick:()=>i.push("/login"),children:"Go to login"})]})})}},57654:function(e,r,t){"use strict";t.d(r,{z:function(){return o}});var n=t(57437),i=t(79580),s=t(575);let o=(0,t(2265).forwardRef)((e,r)=>{let{loading:t,icon:o,children:a,disabled:l,...c}=e,u={type:"button",size:"sm",...c};return t?(0,n.jsxs)(s.z,{...u,ref:r,disabled:l||t,children:[(0,n.jsx)(i.Z,{className:"mr-2 h-4 w-4 animate-spin"}),a]}):(0,n.jsx)(s.z,{...u,ref:r,disabled:l||t,children:o?(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[o,a]}):a})});o.displayName="Button"},575:function(e,r,t){"use strict";t.d(r,{d:function(){return l},z:function(){return c}});var n=t(57437),i=t(2265),s=t(59143),o=t(57742),a=t(22169);let l=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=i.forwardRef((e,r)=>{let{className:t,variant:i,size:o,asChild:c=!1,...u}=e,d=c?s.g7:"button";return(0,n.jsx)(d,{className:(0,a.cn)(l({variant:i,size:o,className:t})),ref:r,...u})});c.displayName="Button"},15671:function(e,r,t){"use strict";t.d(r,{Ol:function(){return a},SZ:function(){return c},Zb:function(){return o},aY:function(){return u},eW:function(){return d},ll:function(){return l}});var n=t(57437),i=t(2265),s=t(22169);let o=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("rounded-xl border bg-card text-card-foreground shadow",t),...i})});o.displayName="Card";let a=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",t),...i})});a.displayName="CardHeader";let l=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)("h3",{ref:r,className:(0,s.cn)("font-semibold leading-none tracking-tight",t),...i})});l.displayName="CardTitle";let c=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)("p",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",t),...i})});c.displayName="CardDescription";let u=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",t),...i})});u.displayName="CardContent";let d=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",t),...i})});d.displayName="CardFooter"},80244:function(e,r,t){"use strict";t.d(r,{NI:function(){return x},Wi:function(){return d},l0:function(){return c},lX:function(){return h},pf:function(){return v},xJ:function(){return p},zG:function(){return g}});var n=t(57437),i=t(2265),s=t(59143),o=t(82670),a=t(22169),l=t(12647);let c=o.RV,u=i.createContext({}),d=e=>{let{...r}=e;return(0,n.jsx)(u.Provider,{value:{name:r.name},children:(0,n.jsx)(o.Qr,{...r})})},f=()=>{let e=i.useContext(u),r=i.useContext(m),{getFieldState:t,formState:n}=(0,o.Gc)(),s=t(e.name,n);if(!e)throw Error("useFormField should be used within <FormField>");let{id:a}=r;return{id:a,name:e.name,formItemId:"".concat(a,"-form-item"),formDescriptionId:"".concat(a,"-form-item-description"),formMessageId:"".concat(a,"-form-item-message"),...s}},m=i.createContext({}),p=i.forwardRef((e,r)=>{let{className:t,...s}=e,o=i.useId();return(0,n.jsx)(m.Provider,{value:{id:o},children:(0,n.jsx)("div",{ref:r,className:(0,a.cn)("space-y-2",t),...s})})});p.displayName="FormItem";let h=i.forwardRef((e,r)=>{let{className:t,...i}=e,{error:s,formItemId:o}=f();return(0,n.jsx)(l._,{ref:r,className:(0,a.cn)(s&&"text-destructive",t),htmlFor:o,...i})});h.displayName="FormLabel";let x=i.forwardRef((e,r)=>{let{...t}=e,{error:i,formItemId:o,formDescriptionId:a,formMessageId:l}=f();return(0,n.jsx)(s.g7,{ref:r,id:o,"aria-describedby":i?"".concat(a," ").concat(l):"".concat(a),"aria-invalid":!!i,...t})});x.displayName="FormControl";let v=i.forwardRef((e,r)=>{let{className:t,...i}=e,{formDescriptionId:s}=f();return(0,n.jsx)("p",{ref:r,id:s,className:(0,a.cn)("text-[0.8rem] text-muted-foreground",t),...i})});v.displayName="FormDescription";let g=i.forwardRef((e,r)=>{let{className:t,children:i,...s}=e,{error:o,formMessageId:l}=f(),c=o?String(null==o?void 0:o.message):i;return c?(0,n.jsx)("p",{ref:r,id:l,className:(0,a.cn)("text-[0.8rem] font-medium text-destructive",t),...s,children:c}):null});g.displayName="FormMessage"},22782:function(e,r,t){"use strict";t.d(r,{I:function(){return o}});var n=t(57437),i=t(2265),s=t(22169);let o=i.forwardRef((e,r)=>{let{className:t,type:i,...o}=e;return(0,n.jsx)("input",{type:i,className:(0,s.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...o})});o.displayName="Input"},12647:function(e,r,t){"use strict";t.d(r,{_:function(){return c}});var n=t(57437),i=t(2265),s=t(24602),o=t(57742),a=t(22169);let l=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=i.forwardRef((e,r)=>{let{className:t,...i}=e;return(0,n.jsx)(s.f,{ref:r,className:(0,a.cn)(l(),t),...i})});c.displayName=s.f.displayName},51919:function(e,r,t){"use strict";t.d(r,{Hl:function(){return i}});let n={on(e,r){"undefined"!=typeof document&&document.addEventListener(e,e=>r(null==e?void 0:e.detail))},dispatch(e,r){"undefined"!=typeof document&&document.dispatchEvent(new CustomEvent(e,{detail:r}))},remove(e,r){"undefined"!=typeof document&&document.removeEventListener(e,r)}};r.ZP=n;let i=e=>{n.dispatch("network-error",e)}},27453:function(e,r,t){"use strict";t.d(r,{Vp:function(){return s},h4:function(){return a},vU:function(){return o}});var n=t(18009);let i=(e,r)=>{(0,n.ZP)(e,{position:"top-center"})},s=(e,r)=>{n.ZP.success(e,{position:"top-center"})},o=(e,r)=>{n.ZP.error(e,{position:"top-center"})},a={info:i,success:s,error:o,warning:(e,r)=>{i(e,r)}}},84971:function(e,r,t){"use strict";t.d(r,{HG:function(){return p},SO:function(){return f},dX:function(){return d},f1:function(){return u},qb:function(){return m}});var n=t(98955),i=t(33108),s=t(51919),o=t(27453);let a=(e,r)=>{let t=n.Z.get(i.B$),s={"Content-Type":"application/json;charset=utf-8",...null!=e?e:{}};return r instanceof FormData&&delete s["Content-Type"],t&&(s.Authorization="Bearer ".concat(t)),s},l=function(e){var r;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"string"==typeof e?e:null!==(r=e.message)&&void 0!==r?r:t},c=async(e,r,t,n)=>{var c,u,d,f;let m=null,p={method:e,mode:"cors",cache:"no-cache",credentials:"same-origin",headers:a(null!==(c=null==n?void 0:n.headers)&&void 0!==c?c:{},t),redirect:"follow",referrerPolicy:"strict-origin-when-cross-origin"};t&&(t instanceof FormData?p.body=t:p.body=JSON.stringify(t));try{if(r.startsWith("http://")||r.startsWith("https://")||(r=i.N9+r),!(m=await fetch(r,p)).ok){let e=null!==(d=m.statusText)&&void 0!==d?d:"Network response was not ok";try{let r=await m.json();e=l(r.error,e)}catch(e){}throw Error(e)}if(null===(u=m.headers.get("Content-Type"))||void 0===u||!u.includes("application/json"))return m;{let e=await m.json();if(e.error)throw Error(l(e.error));return null!==(f=e.data)&&void 0!==f?f:e}}catch(r){console.error(r);let e="";throw(null==n?void 0:n.disableErrorNotification)||o.h4.error(l(r.message,"An error occurred. Please try again later.")),r instanceof Error&&(e=r.message),e.includes("Failed to fetch")&&(0,s.Hl)("An error occurred. Please try again later."),Error(e)}},u=e=>{var r;let t=(null!==(r=e.message)&&void 0!==r?r:"").toLocaleLowerCase();return t.includes("401")||t.includes("unauthorized")},d=async(e,r)=>await c("GET",e,null,r),f=async(e,r,t)=>await c("POST",e,r,t),m=async(e,r,t)=>await c("PUT",e,r,t),p=async(e,r,t)=>await c("DELETE",e,r,t)},33108:function(e,r,t){"use strict";t.d(r,{N9:function(){return d},B$:function(){return f},MJ:function(){return c},gk:function(){return o},aD:function(){return m}});var n,i,s=t(30248);let o=s.z.object({id:s.z.number()}),a=s.z.array(o),l=s.z.object({$nochange:s.z.boolean().optional(),$add:s.z.array(o).optional(),$clear:s.z.array(o).optional()}),c=s.z.union([a,l]);var u=t(49079);let d=null!==(n=u.env.NEXT_PUBLIC_API_BASE_URI)&&void 0!==n?n:"/api",f=null!==(i=u.env.NEXT_PUBLIC_COOKIE_NAME)&&void 0!==i?i:"token",m=["/login/","/register/","/activate/","/setup/"]},53365:function(e,r,t){"use strict";t.d(r,{M8:function(){return c},bG:function(){return o},cY:function(){return a},kS:function(){return u},rw:function(){return d},x4:function(){return l}});var n=t(98955),i=t(84971),s=t(33108);let o=e=>(0,i.dX)("/auth/me",{disableErrorNotification:e}),a=e=>(0,i.SO)("/setup",e),l=e=>(0,i.SO)("/auth/local/login",e),c=e=>{n.Z.set(s.B$,e,{expires:7})},u=()=>{n.Z.remove(s.B$),window.location.href="/dash/login"},d=e=>(e="/".concat(e,"/").replaceAll("//","/"),s.aD.includes(e))},22169:function(e,r,t){"use strict";t.d(r,{cn:function(){return s}});var n=t(75504),i=t(51367);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,i.m6)((0,n.W)(r))}},29586:function(e,r,t){"use strict";t.d(r,{WV:function(){return a},jH:function(){return l}});var n=t(2265),i=t(54887),s=t(59143),o=t(57437),a=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,r)=>{let t=n.forwardRef((e,t)=>{let{asChild:n,...i}=e,a=n?s.g7:r;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,o.jsx)(a,{...i,ref:t})});return t.displayName=`Primitive.${r}`,{...e,[r]:t}},{});function l(e,r){e&&i.flushSync(()=>e.dispatchEvent(r))}}},function(e){e.O(0,[637,147,971,69,744],function(){return e(e.s=28003)}),_N_E=e.O()}]);